"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const util_1=require("util"),common=util_1.deprecate(()=>{},"Common is now deprecated, just access the properties directly");function parseImageUrl(e,t,r){return!e||""===e.trim()||t.is_deleted?null:(e.startsWith("/data")&&(e=`https://danbooru.donmai.us${e}`),e.startsWith("/cached")&&(e=`https://danbooru.donmai.us${e}`),e.startsWith("/_images")&&(e=`https://dollbooru.org${e}`),e.startsWith("//derpicdn.net")&&(e=`https:${t.image}`),!t.file_url&&t.directory&&(e=`//${r.domain}/images/${t.directory}/${t.image}`),e.startsWith("http")||(e=`https:${e}`),e.match(/https?:\/\/lolibooru.moe/)&&(e=t.sample_url.replace(/(.*booru \d+ ).*(\..*)/,"$1sample$2")),encodeURI(e))}class Post{constructor(e,t){this.data=e,this.booru=t,this.fileUrl=parseImageUrl(e.file_url||e.image||e.source,e,t),this.height=parseInt(e.height||e.image_height,10),this.width=parseInt(e.width||e.image_width,10),this.sampleUrl=parseImageUrl(e.sample_url||e.large_file_url||(e.representations?e.representations.large:void 0),e,t),this.sampleHeight=parseInt(e.sample_height,10),this.sampleWidth=parseInt(e.sample_width,10),this.previewUrl=parseImageUrl(e.preview_url||e.preview_file_url||(e.representations?e.representations.small:void 0),e,t),this.previewHeight=parseInt(e.preview_height,10),this.previewWidth=parseInt(e.preview_width,10),this.id=e.id.toString(),this.tags=(e.tags?e.tags.split(" "):e.tag_string.split(" ").map(e=>e.replace(/,/g,"").replace(/ /g,"_"))).filter(e=>""!==e),this.score=parseInt(e.score,10),this.source=e.source,this.rating=e.rating||/(safe|suggestive|questionable|explicit)/i.exec(e.tags)||"u",Array.isArray(this.rating)&&(this.rating=this.rating[0]),"suggestive"===this.rating&&(this.rating="q"),this.rating=this.rating.charAt(0),this.createdAt=null,"object"==typeof e.created_at?this.createdAt=new Date(1e3*e.created_at.s+e.created_at.n/1e9):"number"==typeof e.created_at?this.createdAt=new Date(1e3*e.created_at):this.createdAt=new Date(e.created_at||e.date)}get file_url(){return this.fileUrl}get sample_url(){return this.sampleUrl}get sample_height(){return this.sampleHeight}get sample_width(){return this.sampleWidth}get preview_url(){return this.previewUrl}get preview_height(){return this.previewHeight}get preview_width(){return this.previewWidth}get postView(){return this.booru.postView(this.id)}get common(){return common(),this}}exports.default=Post;